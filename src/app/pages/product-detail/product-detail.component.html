<header class="hero-shell">
  <div class="nav">
    <a class="brand" routerLink="/">Hygiene<span>Market</span></a>
    <form class="search" (submit)="onSearch()" autocomplete="off">
      <div class="search-field">
        <input
          [(ngModel)]="searchQuery"
          name="query"
          type="text"
          [placeholder]="'HOME.SEARCH.PLACEHOLDER' | translate"
          autocomplete="off"
          (input)="updateSuggestions()"
          (focus)="updateSuggestions()"
          (keydown)="onSearchKeydown($event)"
          (blur)="hideSuggestions()"
        />
        <div class="suggestions" *ngIf="showSuggestions">
          <button
            class="suggestion-item"
            type="button"
            *ngFor="let suggestion of suggestions"
            (click)="selectSuggestion(suggestion)"
            [class.active]="suggestions[highlightedIndex]?.id === suggestion.id"
          >
            <span>{{ suggestion.name }}</span>
            <span class="tag">{{ suggestion.category }}</span>
          </button>
        </div>
      </div>
      <button type="submit">{{ 'HOME.SEARCH.BUTTON' | translate }}</button>
    </form>
    <div class="nav-actions">
      <div class="lang-menu" [attr.title]="'NAV.LANGUAGE' | translate">
        <button class="icon-btn" type="button" [attr.aria-label]="'NAV.LANGUAGE' | translate">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="1.6" />
            <path
              d="M3 12h18M12 3a14 14 0 0 1 0 18M12 3a14 14 0 0 0 0 18"
              fill="none"
              stroke="currentColor"
              stroke-width="1.4"
              stroke-linecap="round"
            />
          </svg>
        </button>
        <div class="lang-dropdown">
          <button type="button" (click)="changeLanguage('en')">{{ 'LANG.EN' | translate }}</button>
          <button type="button" (click)="changeLanguage('ar')">{{ 'LANG.AR' | translate }}</button>
          <button type="button" (click)="changeLanguage('fr')">{{ 'LANG.FR' | translate }}</button>
          <button type="button" (click)="changeLanguage('es')">{{ 'LANG.ES' | translate }}</button>
        </div>
      </div>
      <a class="icon-btn" routerLink="/" [attr.title]="'NAV.SHOP' | translate" [attr.aria-label]="'NAV.SHOP' | translate">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M4 11l8-6 8 6v8a2 2 0 0 1-2 2h-4v-6H10v6H6a2 2 0 0 1-2-2z"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linejoin="round"
          />
        </svg>
      </a>
      <a class="icon-btn" routerLink="/cart" [attr.title]="'NAV.CART' | translate" [attr.aria-label]="'NAV.CART' | translate">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M7 6h14l-2 9H8L6 4H3"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <circle cx="9" cy="20" r="1.5" fill="currentColor" />
          <circle cx="18" cy="20" r="1.5" fill="currentColor" />
        </svg>
      </a>
      <a class="icon-btn" routerLink="/profile" *ngIf="currentUser" [attr.title]="'NAV.PROFILE' | translate" [attr.aria-label]="'NAV.PROFILE' | translate">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle
            cx="12"
            cy="8"
            r="4"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
          />
          <path
            d="M4 20c1.6-3 4.6-5 8-5s6.4 2 8 5"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
          />
        </svg>
      </a>
      <button class="icon-btn" type="button" *ngIf="currentUser" (click)="logout()" [attr.title]="'NAV.LOGOUT' | translate" [attr.aria-label]="'NAV.LOGOUT' | translate">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path
            d="M9 4H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h4"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
          />
          <path
            d="M16 16l4-4-4-4"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M20 12H9"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
          />
        </svg>
      </button>
      <a class="icon-btn" routerLink="/login" *ngIf="!currentUser" [attr.title]="'NAV.SIGN_IN' | translate" [attr.aria-label]="'NAV.SIGN_IN' | translate">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <rect
            x="3"
            y="11"
            width="18"
            height="9"
            rx="2"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
          />
          <path
            d="M7 11V8a5 5 0 0 1 10 0v3"
            fill="none"
            stroke="currentColor"
            stroke-width="1.6"
            stroke-linecap="round"
          />
        </svg>
      </a>
    </div>
  </div>
</header>

<main>
  <nav class="breadcrumb" aria-label="Breadcrumb" *ngIf="product">
    <a routerLink="/">{{ 'NAV.SHOP' | translate }}</a>
    <span>/</span>
    <a routerLink="/">{{ 'PRODUCT.BREADCRUMB_PRODUCTS' | translate }}</a>
    <span>/</span>
    <a [routerLink]="['/']" [queryParams]="{ q: product.category }">{{ product.category }}</a>
    <span>/</span>
    <span class="current">{{ product.name }}</span>
  </nav>
  <div class="spinner-wrap" *ngIf="isLoadingProduct">
    <div class="spinner" aria-hidden="true"></div>
  </div>
  <section class="detail-card" *ngIf="product && !isLoadingProduct">
    <div class="image-panel">
      <img
        [src]="product.imageUrl || placeholderImage"
        [alt]="product.name"
        (error)="onImageError($event)"
      />
    </div>
    <div class="info-panel">
      <p class="eyebrow">{{ product.category }}</p>
      <h1>{{ product.name }}</h1>
      <p class="desc">{{ product.description }}</p>
      <div class="meta-grid">
        <div>
          <span class="label">{{ 'PRODUCT.PRICE' | translate }}</span>
          <strong>{{ product.currency }} {{ product.price }}</strong>
        </div>
        <div>
          <span class="label">{{ 'PRODUCT.SKU' | translate }}</span>
          <strong>{{ product.sku || 'â€”' }}</strong>
        </div>
        <div>
          <span class="label">{{ 'PRODUCT.CATEGORY' | translate }}</span>
          <strong>{{ product.category }}</strong>
        </div>
      </div>
      <button class="btn btn-primary big" type="button" (click)="addToCart(product.id)">
        {{ 'PRODUCT.ADD_TO_CART' | translate }}
      </button>
    </div>
  </section>

  <p class="status" *ngIf="statusKey && !isLoadingProduct">{{ statusKey | translate }}</p>

  <section class="similar" *ngIf="similarProducts.length">
    <div class="section-head">
      <h2>{{ 'PRODUCT.SIMILAR' | translate }}</h2>
    </div>
    <div class="grid">
      <div class="card" *ngFor="let item of similarProducts" (click)="goToProduct(item.id)">
        <div class="card-media">
          <img [src]="item.imageUrl || placeholderImage" [alt]="item.name" (error)="onImageError($event)" />
        </div>
        <div class="card-body">
          <strong>{{ item.name }}</strong>
          <span class="status">{{ item.category }}</span>
          <span class="price">{{ item.currency }} {{ item.price }}</span>
        </div>
      </div>
    </div>
  </section>
</main>

<div class="toast" *ngIf="showToast" [class.error]="toastType === 'error'">
  {{ toastMessage }}
</div>
